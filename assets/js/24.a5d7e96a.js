(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{343:function(n,e,a){"use strict";a.r(e);var t=a(25),i=Object(t.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"connmanctl环境适配"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connmanctl环境适配"}},[n._v("#")]),n._v(" connmanctl环境适配")]),n._v(" "),e("p",[n._v("复制/etc/init.d/S22config_env、/etc/init.d/S45connman、/usr/sbin/connmand、/usr/bin/connmanctl 到对应的文件夹中")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('[root@MiWiFi-R4AC-srv:/etc/init.d]# cat S22config_env\n#!/bin/sh\n\nconnman_dir=/userdata/connman\n\ncase "$1" in\n    start)\n        [ ! -d "$connman_dir" ] && mkdir -p "$connman_dir"\n        [ ! -L "/var/lib/connman" ] && ln -sf /userdata/connman /var/lib/connman\n        ;;\n    stop)\n        printf "$0 stop finished\\n"\n        ;;\n    *)\n        echo "Usage: $0 {start|stop}"\n        exit 1\n        ;;\nesac\nexit 0\n[root@MiWiFi-R4AC-srv:/etc/init.d]# cat S45connman\n#!/bin/sh\n\ncase "$1" in\n    start)\n        printf "Starting connman ... "\n        start-stop-daemon -S -q -m -b -p /var/run/connmand.pid --exec /usr/sbin/connmand -- -n\n        echo "done."\n        ;;\n    stop)\n        printf "Stopping connman ..."\n        start-stop-daemon -K -q -p /var/run/connmand.pid\n        echo "done."\n        ;;\n    restart)\n        $0 stop\n        sleep 1\n        $0 start\n        ;;\n    *)\n        echo "usage: $0 {start|stop|restart}"\n        ;;\nesac\n[root@MiWiFi-R4AC-srv:/etc/init.d]#\n')])])]),e("h1",{attrs:{id:"无线-wlan"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#无线-wlan"}},[n._v("#")]),n._v(" 无线（wlan）")]),n._v(" "),e("h2",{attrs:{id:"connmanctl"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connmanctl"}},[n._v("#")]),n._v(" connmanctl")]),n._v(" "),e("h3",{attrs:{id:"使用配置文件连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用配置文件连接"}},[n._v("#")]),n._v(" 使用配置文件连接")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:~]# connmanctl disable wifi\nDisabled wifi\n[root@MiWiFi-R4AC-srv:~]# connmanctl enable wifi\nEnabled wifi\n[root@MiWiFi-R4AC-srv:~]# connmanctl scan wifi\nScan completed for wifi\n[root@MiWiFi-R4AC-srv:~]# connmanctl services\n*AO Wired                ethernet_301f9a701166_cable\n*A  Xiaomi_BFEB          wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n    Hanma                wifi_b813323463f6_48616e6d61_managed_psk\n    ChinaNet-Disv        wifi_b813323463f6_4368696e614e65742d44697376_managed_psk\n    GZLH-2               wifi_b813323463f6_475a4c482d32_managed_psk\n    TP-LINK_D5D0         wifi_b813323463f6_54502d4c494e4b5f44354430_managed_psk\n    guosheng             wifi_b813323463f6_67756f7368656e67_managed_psk\n                         wifi_b813323463f6_hidden_managed_none\n    GZKH-2               wifi_b813323463f6_475a4b482d32_managed_psk\n    GZKH                 wifi_b813323463f6_475a4b48_managed_psk\n    k2p-26F3             wifi_b813323463f6_6b32702d32364633_managed_none\n    TP-LINK_F6A0         wifi_b813323463f6_54502d4c494e4b5f46364130_managed_psk\n[root@MiWiFi-R4AC-srv:~]# vi /var/lib/connman/Xiaomi_BFEB-psk.config\n[root@MiWiFi-R4AC-srv:~]# connmanctl connect wifi_b813323463f6_5869616f6d695f42464542_managed_psk\nConnected wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n[root@MiWiFi-R4AC-srv:~]# connmanctl services\n*AO Wired                ethernet_301f9a701166_cable\n*AR Xiaomi_BFEB          wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n    Hanma                wifi_b813323463f6_48616e6d61_managed_psk\n    ChinaNet-Disv        wifi_b813323463f6_4368696e614e65742d44697376_managed_psk\n    GZLH-2               wifi_b813323463f6_475a4c482d32_managed_psk\n    TP-LINK_D5D0         wifi_b813323463f6_54502d4c494e4b5f44354430_managed_psk\n    guosheng             wifi_b813323463f6_67756f7368656e67_managed_psk\n                         wifi_b813323463f6_hidden_managed_none\n    ChinaNet-ZVy7        wifi_b813323463f6_4368696e614e65742d5a567937_managed_psk\n    H3C_AC05B2_WIFI5     wifi_b813323463f6_4833435f4143303542325f5749464935_managed_none\n    GZKH-2               wifi_b813323463f6_475a4b482d32_managed_psk\n    esoon_app            wifi_b813323463f6_65736f6f6e5f617070_managed_psk\n    GZKH                 wifi_b813323463f6_475a4b48_managed_psk\n    esoon                wifi_b813323463f6_65736f6f6e_managed_psk\n")])])]),e("p",[n._v("其中Xiaomi_BFEB-psk.config文件内容")]),n._v(" "),e("div",{staticClass:"language-ini{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[service_wifi_b813323463f6_5869616f6d695f42464542_managed_psk]\nType = wifi\nName = Xiaomi_BFEB\nPassphrase = hanma2023\nIPv4 = 192.168.31.218/255.255.255.0/192.168.31.1\nNameservers = 192.168.31.1,8.8.8.8\n")])])]),e("p",[n._v("参考链接\n"),e("a",{attrs:{href:"https://blog.csdn.net/baidu_33879812/article/details/100098586",target:"_blank",rel:"noopener noreferrer"}},[n._v("connman康恩曼wifi连接"),e("OutboundLink")],1)]),n._v(" "),e("h3",{attrs:{id:"使用命令连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用命令连接"}},[n._v("#")]),n._v(" 使用命令连接")]),n._v(" "),e("p",[n._v("启用与禁用 wifi\n执行 connmanctl technologies 来检查 wifi 是否开启，查看类似 Powered: True/False 的输出。")]),n._v(" "),e("p",[n._v("连接到公开的接入点")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:~]# connmanctl scan wifi\n在扫描之后，列出可用的网络（示例输出）：\n\n[root@MiWiFi-R4AC-srv:~]# connmanctl services\n*AO MyNetwork               wifi_dc85de828967_68756773616d_managed_psk\n    OtherNET                wifi_dc85de828967_38303944616e69656c73_managed_psk\n    AnotherOne              wifi_dc85de828967_3257495245363836_managed_wep\n    FourthNetwork           wifi_dc85de828967_4d7572706879_managed_wep\n    AnOpenNetwork           wifi_dc85de828967_4d6568657272696e_managed_none\n要连接到公开的网络，使用以 wifi_ 开头的第二个参数:\n\n[root@MiWiFi-R4AC-srv:~]# connmanctl connect wifi_dc85de828967_4d6568657272696e_managed_none\n提示：网络名称可以用 tab 补全。\n你现在应该已经连上网络了，使用 connmanctl state 或 ip addr 来检查。\n")])])]),e("p",[n._v("连接到受保护的接入点")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:~]# connmanctl\nconnmanctl> scan wifi\nScan completed for wifi\nconnmanctl> services\n*AO Wired                ethernet_301f9a701166_cable\n    Xiaomi_BFEB          wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n    Hanma                wifi_b813323463f6_48616e6d61_managed_psk\n    GZLH-2               wifi_b813323463f6_475a4c482d32_managed_psk\n    ChinaNet-Disv        wifi_b813323463f6_4368696e614e65742d44697376_managed_psk\n    TP-LINK_D5D0         wifi_b813323463f6_54502d4c494e4b5f44354430_managed_psk\n    TP-LINK_8C46         wifi_b813323463f6_54502d4c494e4b5f38433436_managed_psk\n    ChinaNet-ZVy7        wifi_b813323463f6_4368696e614e65742d5a567937_managed_psk\n    esoon_app            wifi_b813323463f6_65736f6f6e5f617070_managed_psk\nconnmanctl> agent on\nAgent registered\nconnmanctl> connect wifi_b813323463f6_5869616f6d695f42464542_managed_psk\nAgent RequestInput wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n  Passphrase = [ Type=psk, Requirement=mandatory, Alternates=[ WPS ] ]\n  WPS = [ Type=wpspin, Requirement=alternate ]\nPassphrase? hanma2023\nConnected wifi_b813323463f6_5869616f6d695f42464542_managed_psk\nconnmanctl> services\n*AO Wired                ethernet_301f9a701166_cable\n*AR Xiaomi_BFEB          wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n    Hanma                wifi_b813323463f6_48616e6d61_managed_psk\n    GZLH-2               wifi_b813323463f6_475a4c482d32_managed_psk\n    ChinaNet-Disv        wifi_b813323463f6_4368696e614e65742d44697376_managed_psk\n    TP-LINK_D5D0         wifi_b813323463f6_54502d4c494e4b5f44354430_managed_psk\n    Assembly Plant       wifi_b813323463f6_417373656d626c7920506c616e74_managed_psk\n    TP-LINK_8C46         wifi_b813323463f6_54502d4c494e4b5f38433436_managed_psk\n                         wifi_b813323463f6_hidden_managed_none\n    ChinaNet-ZVy7        wifi_b813323463f6_4368696e614e65742d5a567937_managed_psk\n    esoon_app            wifi_b813323463f6_65736f6f6e5f617070_managed_psk\nconnmanctl> quit\n[root@MiWiFi-R4AC-srv:~]#\n\n")])])]),e("p",[n._v("静态IP")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:/userdata/connman]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:11:66 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.115/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP8000> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether b8:13:32:34:63:f6 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.49/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@MiWiFi-R4AC-srv:/userdata/connman]# ls\nethernet_301f9a701166_cable  settings  wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl services wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n/net/connman/service/wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n  Type = wifi\n  Security = [ psk, wps ]\n  State = ready\n  Strength = 95\n  Favorite = True\n  Immutable = False\n  AutoConnect = True\n  Name = Xiaomi_BFEB\n  Ethernet = [ Method=auto, Interface=wlan0, Address=B8:13:32:34:63:F6, MTU=1500 ]\n  IPv4 = [ Method=dhcp, Address=192.168.31.49, Netmask=255.255.255.0 ]\n  IPv4.Configuration = [ Method=dhcp ]\n  IPv6 = [  ]\n  IPv6.Configuration = [ Method=off ]\n  Nameservers = [ 192.168.31.1 ]\n  Nameservers.Configuration = [  ]\n  Timeservers = [ 192.168.31.1 ]\n  Timeservers.Configuration = [  ]\n  Domains = [  ]\n  Domains.Configuration = [  ]\n  Proxy = [ Method=direct ]\n  Proxy.Configuration = [  ]\n  Provider = [  ]\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl config wifi_b813323463f6_5869616f6d695f42464542_managed_psk --ipv4 manual\n 192.168.31.149 255.255.255.0 192.168.31.1 --nameservers 192.168.31.1 8.8.8.8\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl services wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n/net/connman/service/wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n  Type = wifi\n  Security = [ psk, wps ]\n  State = ready\n  Strength = 95\n  Favorite = True\n  Immutable = False\n  AutoConnect = True\n  Name = Xiaomi_BFEB\n  Ethernet = [ Method=auto, Interface=wlan0, Address=B8:13:32:34:63:F6, MTU=1500 ]\n  IPv4 = [ Method=manual, Address=192.168.31.149, Netmask=255.255.255.0 ]\n  IPv4.Configuration = [ Method=manual, Address=192.168.31.149, Netmask=255.255.255.0, Gateway=192.168.31.1 ]\n  IPv6 = [  ]\n  IPv6.Configuration = [ Method=off ]\n  Nameservers = [ 192.168.31.1, 8.8.8.8 ]\n  Nameservers.Configuration = [ 192.168.31.1, 8.8.8.8 ]\n  Timeservers = [ 192.168.31.1 ]\n  Timeservers.Configuration = [  ]\n  Domains = [  ]\n  Domains.Configuration = [  ]\n  Proxy = [ Method=direct ]\n  Proxy.Configuration = [  ]\n  Provider = [  ]\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl config wifi_b813323463f6_5869616f6d695f42464542_managed_psk --ipv4 dhcp\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl services wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n/net/connman/service/wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n  Type = wifi\n  Security = [ psk, wps ]\n  State = ready\n  Strength = 94\n  Favorite = True\n  Immutable = False\n  AutoConnect = True\n  Name = Xiaomi_BFEB\n  Ethernet = [ Method=auto, Interface=wlan0, Address=B8:13:32:34:63:F6, MTU=1500 ]\n  IPv4 = [ Method=dhcp, Address=192.168.31.49, Netmask=255.255.255.0 ]\n  IPv4.Configuration = [ Method=dhcp ]\n  IPv6 = [  ]\n  IPv6.Configuration = [ Method=off ]\n  Nameservers = [ 192.168.31.1, 8.8.8.8 ]\n  Nameservers.Configuration = [ 192.168.31.1, 8.8.8.8 ]\n  Timeservers = [ 192.168.31.1 ]\n  Timeservers.Configuration = [  ]\n  Domains = [  ]\n  Domains.Configuration = [  ]\n  Proxy = [ Method=direct ]\n  Proxy.Configuration = [  ]\n  Provider = [  ]\n[root@MiWiFi-R4AC-srv:/userdata/connman]#\n\n\n# 设置自动连接\nconfig wifi_4479a2e30e16_5445535431363838_managed_psk --autoconnect no\nconfig wifi_4479a2e30e16_5445535431363838_managed_psk--autoconnect yes\n# 移除\nconfig wifi_4479a2e30e16_5445535431363838_managed_psk --remove\n")])])]),e("h3",{attrs:{id:"其他常用命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他常用命令"}},[n._v("#")]),n._v(" 其他常用命令")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl technologies\n/net/connman/technology/p2p\n  Name = P2P\n  Type = p2p\n  Powered = False\n  Connected = False\n  Tethering = False\n/net/connman/technology/ethernet\n  Name = Wired\n  Type = ethernet\n  Powered = True\n  Connected = True\n  Tethering = False\n/net/connman/technology/wifi\n  Name = WiFi\n  Type = wifi\n  Powered = True\n  Connected = False\n  Tethering = False\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl services wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n/net/connman/service/wifi_b813323463f6_5869616f6d695f42464542_managed_psk\n  Type = wifi\n  Security = [ psk, wps ]\n  State = ready\n  Strength = 100\n  Favorite = True\n  Immutable = True\n  AutoConnect = True\n  Name = Xiaomi_BFEB\n  Ethernet = [ Method=auto, Interface=wlan0, Address=B8:13:32:34:63:F6, MTU=1500 ]\n  IPv4 = [ Method=fixed, Address=192.168.31.218, Netmask=255.255.255.0, Gateway=192.168.31.1 ]\n  IPv4.Configuration = [ Method=fixed, Address=192.168.31.218, Netmask=255.255.255.0, Gateway=192.168.31.1 ]\n  IPv6 = [  ]\n  IPv6.Configuration = [ Method=auto, Privacy=disabled ]\n  Nameservers = [ 192.168.31.1, 8.8.8.8 ]\n  Nameservers.Configuration = [  ]\n  Timeservers = [ 192.168.31.1 ]\n  Timeservers.Configuration = [  ]\n  Domains = [  ]\n  Domains.Configuration = [  ]\n  Proxy = [ Method=direct ]\n  Proxy.Configuration = [  ]\n  Provider = [  ]\n")])])]),e("h3",{attrs:{id:"疑难杂症"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#疑难杂症"}},[n._v("#")]),n._v(" 疑难杂症")]),n._v(" "),e("p",[n._v("Error /net/connman/technology/wifi: Not supported")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl scan wifi\nError /net/connman/technology/wifi: Not supported\n[root@MiWiFi-R4AC-srv:/userdata/connman]# wpa_supplicant -u &\n[root@MiWiFi-R4AC-srv:/userdata/connman]# Successfully initialized wpa_supplicant\nWPS: Converting push_button to virtual_push_button for WPS 2.0 compliance\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl scan wifi\nScan completed for wifi\n")])])]),e("h2",{attrs:{id:"wpa-cli"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wpa-cli"}},[n._v("#")]),n._v(" wpa_cli")]),n._v(" "),e("h3",{attrs:{id:"使用配置文件连接-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用配置文件连接-2"}},[n._v("#")]),n._v(" 使用配置文件连接")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@RV1126_RV1109:~]# ifconfig wlan0 down\n[root@RV1126_RV1109:~]# killall wpa_supplicant\n[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant scan\nFailed to connect to non-global ctrl_ifname: wlan0  error: No such file or directory\n[root@RV1126_RV1109:~]# export LD_LIBRARY_PATH=/hanma/lib:${LD_LIBRARY_PATH}\n[root@RV1126_RV1109:~]# wpa_supplicant -D nl80211 -c /data/cfg/wpa_supplicant.conf -i wlan0 -B\nSuccessfully initialized wpa_supplicant\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant scan\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant scan_results\nbssid / frequency / signal level / flags / ssid\n8c:53:c3:87:bf:ec       2447    -18     [WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][WPS][ESS]       Xiaomi_BFEB\na8:c9:8a:7c:88:07       2412    -36     [WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]      Hanma\ncc:c2:e0:67:94:89       2472    -34     [WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][ESS]    ChinaNet-Disv\n3c:06:a7:4d:d5:d0       2437    -57     [WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]      TP-LINK_D5D0\n70:c6:dd:36:78:e0       2462    -56     [WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]      GZLH-2\n60:3a:7c:25:8c:46       2457    -64     [WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]      TP-LINK_8C46\n08:3a:38:ac:05:b4       2462    -70     [WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]      GZKH\n[root@RV1126_RV1109:~]# vi /data/cfg/wpa_supplicant.conf\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant reconfigure\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant status\nbssid=8c:53:c3:87:bf:ec\nfreq=2447\nssid=Xiaomi_BFEB\nid=0\nmode=station\npairwise_cipher=CCMP\ngroup_cipher=TKIP\nkey_mgmt=WPA2-PSK\nwpa_state=COMPLETED\nip_address=192.168.31.51\np2p_device_address=52:41:1c:bf:18:24\naddress=50:41:1c:bf:18:24\nuuid=c63e8730-ff1c-5838-a816-6abf30371e8f\n[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.51/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant reconnect\nOK\n[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.51/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@RV1126_RV1109:~]#\n")])])]),e("p",[n._v("其中 /data/cfg/wpa_supplicant.conf")]),n._v(" "),e("div",{staticClass:"language-{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('ctrl_interface=/var/run/wpa_supplicant\nupdate_config=1\n\nnetwork={\n        ssid="Xiaomi_BFEB"\n        scan_ssid=1\n        psk="hanma2023"\n}\n\n')])])]),e("h3",{attrs:{id:"使用命令配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用命令配置"}},[n._v("#")]),n._v(" 使用命令配置")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('[root@RV1126_RV1109:~]# ifconfig wlan0 down\n[root@RV1126_RV1109:~]# killall wpa_supplicant\n[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n[root@RV1126_RV1109:~]# export LD_LIBRARY_PATH=/hanma/lib:${LD_LIBRARY_PATH}\n[root@RV1126_RV1109:~]# wpa_supplicant -D nl80211 -c /data/cfg/wpa_supplicant.conf -i wlan0 -B\nSuccessfully initialized wpa_supplicant\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant remove_network 0\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant ap_scan 1\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant add_network\n0\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant status\nwpa_state=INACTIVE\np2p_device_address=52:41:1c:bf:18:24\naddress=50:41:1c:bf:18:24\nuuid=c63e8730-ff1c-5838-a816-6abf30371e8f\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant set_network 0 ssid \'"Hanma"\'\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant set_network 0 key_mgmt WPA-PSK\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant set_network 0 psk \'"@Hanma2018"\'\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant select_network 0\nOK\n[root@RV1126_RV1109:~]# cat /data/cfg/wpa_supplicant.conf\nctrl_interface=/var/run/wpa_supplicant\nupdate_config=1\n\nnetwork={\n        ssid="Xiaomi_BFEB"\n        scan_ssid=1\n        psk="hanma2023"\n}\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant save_config\nOK\n[root@RV1126_RV1109:~]# wpa_cli -i wlan0 -p /var/run/wpa_supplicant status\nbssid=a8:c9:8a:7c:88:07\nfreq=2412\nssid=Hanma\nid=0\nmode=station\npairwise_cipher=CCMP\ngroup_cipher=CCMP\nkey_mgmt=WPA2-PSK\nwpa_state=COMPLETED\nip_address=192.168.0.103\np2p_device_address=52:41:1c:bf:18:24\naddress=50:41:1c:bf:18:24\nuuid=c63e8730-ff1c-5838-a816-6abf30371e8f\n[root@RV1126_RV1109:~]# cat /data/cfg/wpa_supplicant.conf\nctrl_interface=/var/run/wpa_supplicant\nupdate_config=1\n\nnetwork={\n        ssid="Hanma"\n        psk="@Hanma2018"\n        key_mgmt=WPA-PSK\n}\n[root@RV1126_RV1109:~]#\n')])])]),e("p",[n._v("连接不加密的热点")]),n._v(" "),e("blockquote",[e("p",[n._v("wpa_cli -i wlan0 -p /var/run/wpa_supplicant set_network 0 key_mgmt NONE")])]),n._v(" "),e("h3",{attrs:{id:"疑难杂症-2"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#疑难杂症-2"}},[n._v("#")]),n._v(" 疑难杂症")]),n._v(" "),e("p",[n._v("1、Failed to connect to non-global ctrl_ifname: wlan0  error: No such file or directory")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:/userdata/connman]# wpa_cli -i wlan0 status\nFailed to connect to non-global ctrl_ifname: wlan0  error: No such file or directory\n[root@MiWiFi-R4AC-srv:/userdata/connman]# wpa_supplicant -D nl80211 -c /data/cfg/wpa_supplicant.conf -i wlan0 -B\nSuccessfully initialized wpa_supplicant\n[root@MiWiFi-R4AC-srv:/userdata/connman]# wpa_cli -i wlan0 status\nwpa_state=SCANNING\nip_address=192.168.31.218\np2p_device_address=ba:13:32:34:63:f6\naddress=b8:13:32:34:63:f6\nuuid=b60e10d5-0f1d-571b-8af7-9735c1589308\n")])])]),e("h3",{attrs:{id:"参考文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[n._v("#")]),n._v(" 参考文档")]),n._v(" "),e("p",[n._v("/docs/Linux/Wifibt/Rockchip_Developer_Guide_Linux_WIFI_BT_CN.pdf")]),n._v(" "),e("h3",{attrs:{id:"使用静态ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用静态ip"}},[n._v("#")]),n._v(" 使用静态IP")]),n._v(" "),e("p",[n._v("在 /etc/dhcpcd.conf 添加")]),n._v(" "),e("div",{staticClass:"language-{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("interface wlan0\nstatic ip_address=192.168.31.52/24\nstatic routers=192.168.31.1\nstatic domain_name_servers=192.168.31.1 8.8.8.8\n")])])]),e("p",[n._v("掩码换算")]),n._v(" "),e("div",{staticClass:"language-cpp{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('int dotToInt(QString netmask){\n    QStringList netmaskList = netmask.split(".");\n    int iNetmask = ((netmaskList[0].toInt())<<24)+((netmaskList[1].toInt())<<16)+\\\n                ((netmaskList[2].toInt())<<8)+((netmaskList[3].toInt()));\n    int _netmask = 0;\n    int tag = 1;\n    while (tag != 0) {\n        if ((tag&iNetmask) != 0) {\n            _netmask++;\n        }\n        tag = tag << 1;\n    }\n    return _netmask;\n}\n')])])]),e("p",[n._v("重新分配IP")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.52/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@RV1126_RV1109:~]# ip addr flush wlan0;\n[root@RV1126_RV1109:~]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:30:f5 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.108/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 50:41:1c:bf:18:24 brd ff:ff:ff:ff:ff:ff\n[root@RV1126_RV1109:~]# /etc/init.d/S41dhcpcd restart;\nStopping dhcpcd...\nstopped /sbin/dhcpcd (pid 3709)\nStarting dhcpcd...\ndev: loaded udev\nall: IPv6 kernel autoconf disabled\nall: IPv6 kernel autoconf disabled\nDUID 00:01:00:01:c7:92:bc:8e:00:00:00:00:00:00\neth0: IAID 9a:70:30:f5\neth0: adding address fe80::a2de:c13e:34ee:c330\nif_addaddress6: Operation not supported\nwlan0: IAID 1c:bf:18:24\nwlan0: adding address fe80::9220:b834:4adc:76e9\nif_addaddress6: Operation not supported\nwlan0: probing address 192.168.31.52/24\neth0: rebinding lease of 192.168.31.108\neth0: leased 192.168.31.108 for 43200 seconds\neth0: changing route to 192.168.31.0/24\neth0: changing default route via 192.168.31.1\nforked to background, child pid 3440\n[root@RV1126_RV1109:~]# cat /etc/init.d/S41dhcpcd\n#!/bin/sh\n#\n# Start/stop dhcpcd\n#\n\nDAEMON=/sbin/dhcpcd\nCONFIG=/etc/dhcpcd.conf\nPIDFILE=/var/run/dhcpcd.pid\n\n[ -x $DAEMON ] || exit 0\n[ -f $CONFIG ] || exit 0\n\ncase "$1" in\n  start)\n        echo "Starting dhcpcd..."\n        start-stop-daemon -S -x "$DAEMON" -p "$PIDFILE" -- -f "$CONFIG"\n        ;;\n  stop)\n        echo "Stopping dhcpcd..."\n        start-stop-daemon -K -x "$DAEMON" -p "$PIDFILE" -o\n        ;;\n  reload|force-reload)\n        echo "Reloading dhcpcd configuration..."\n        "$DAEMON" -s reload\n        ;;\n  restart)\n        "$0" stop\n        sleep 1 # Prevent race condition: ensure dhcpcd stops before start.\n        "$0" start\n        ;;\n  *)\n        echo "Usage: $0 {start|stop|restart|reload|force-reload}"\n        exit 1\nesac\n[root@RV1126_RV1109:~]#\n')])])]),e("h1",{attrs:{id:"以太网-ethernet"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#以太网-ethernet"}},[n._v("#")]),n._v(" 以太网（Ethernet）")]),n._v(" "),e("h2",{attrs:{id:"设置动态、静态ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#设置动态、静态ip"}},[n._v("#")]),n._v(" 设置动态、静态IP")]),n._v(" "),e("div",{staticClass:"language-shell{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("[root@MiWiFi-R4AC-srv:/userdata/connman]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:11:66 brd ff:ff:ff:ff:ff:ff\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP8000> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether b8:13:32:34:63:f6 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.49/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl config ethernet_301f9a701166_cable --ipv4 manual 192.168.31.116 255.255.255.0 192.168.31.1 --nameservers 192.168.31.1 8.8.8.8\n[root@MiWiFi-R4AC-srv:/userdata/connman]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:11:66 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.116/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP8000> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether b8:13:32:34:63:f6 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.49/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@MiWiFi-R4AC-srv:/userdata/connman]# connmanctl config ethernet_301f9a701166_cable --ipv4 dhcp\n[root@MiWiFi-R4AC-srv:/userdata/connman]# ip addr show\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\n    link/ether 30:1f:9a:70:11:66 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.115/24 brd 192.168.31.255 scope global eth0\n       valid_lft forever preferred_lft forever\n3: wlan0: <BROADCAST,MULTICAST,UP,LOWER_UP8000> mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether b8:13:32:34:63:f6 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.31.49/24 brd 192.168.31.255 scope global wlan0\n       valid_lft forever preferred_lft forever\n[root@MiWiFi-R4AC-srv:/userdata/connman]#\n")])])]),e("h2",{attrs:{id:"wpa-cli设置静态ip"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#wpa-cli设置静态ip"}},[n._v("#")]),n._v(" wpa_cli设置静态IP")]),n._v(" "),e("p",[n._v("在 /etc/dhcpcd.conf 添加")]),n._v(" "),e("div",{staticClass:"language-{.line-numbers} extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("interface eth0\nstatic ip_address=192.168.31.52/24\nstatic routers=192.168.31.1\nstatic domain_name_servers=192.168.31.1 8.8.8.8\n")])])])])}),[],!1,null,null,null);e.default=i.exports}}]);